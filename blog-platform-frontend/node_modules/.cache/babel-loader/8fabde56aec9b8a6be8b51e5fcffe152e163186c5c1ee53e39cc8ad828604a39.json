{"ast":null,"code":"import _objectSpread from\"C:/Users/Arbisjan/Desktop/GIT/Blog Platform/blog-platform-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from\"react\";import{fetchProfile,updateProfile}from\"../api\";// Import updateProfile too\nimport{useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Profile(){const[profile,setProfile]=useState(null);const[form,setForm]=useState({bio:\"\",avatar:null});const navigate=useNavigate();useEffect(()=>{const token=localStorage.getItem(\"token\");if(token){fetchProfile(token).then(data=>{setProfile(data);setForm({bio:data.bio||\"\",avatar:null});}).catch(()=>{setProfile(null);navigate(\"/login\");});}else{navigate(\"/login\");}},[navigate]);const handleChange=e=>{if(e.target.name===\"avatar\"){setForm(_objectSpread(_objectSpread({},form),{},{avatar:e.target.files[0]}));}else{setForm(_objectSpread(_objectSpread({},form),{},{[e.target.name]:e.target.value}));}};const handleSubmit=async e=>{e.preventDefault();const token=localStorage.getItem(\"token\");if(!token){navigate(\"/login\");return;}const formData=new FormData();formData.append(\"bio\",form.bio);if(form.avatar)formData.append(\"avatar\",form.avatar);try{await updateProfile(token,formData);window.location.reload();}catch(err){alert(\"Update failed\");}};if(!profile)return/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Profile\"}),/*#__PURE__*/_jsx(\"img\",{src:profile.avatar?profile.avatar:\"https://via.placeholder.com/100\",alt:\"avatar\",width:\"100\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Username: \",profile.username]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Email: \",profile.email]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Reputation: \",profile.reputation]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"textarea\",{name:\"bio\",value:form.bio,onChange:handleChange,placeholder:\"Bio\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"avatar\",onChange:handleChange}),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",type:\"submit\",children:\"Update Profile\"})]})]});}export default Profile;","map":{"version":3,"names":["React","useEffect","useState","fetchProfile","updateProfile","useNavigate","jsx","_jsx","jsxs","_jsxs","Profile","profile","setProfile","form","setForm","bio","avatar","navigate","token","localStorage","getItem","then","data","catch","handleChange","e","target","name","_objectSpread","files","value","handleSubmit","preventDefault","formData","FormData","append","window","location","reload","err","alert","children","src","alt","width","username","email","reputation","onSubmit","onChange","placeholder","type","className"],"sources":["C:/Users/Arbisjan/Desktop/GIT/Blog Platform/blog-platform-frontend/src/pages/Profile.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { fetchProfile, updateProfile } from \"../api\"; // Import updateProfile too\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nfunction Profile() {\r\n  const [profile, setProfile] = useState(null);\r\n  const [form, setForm] = useState({ bio: \"\", avatar: null });\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"token\");\r\n    if (token) {\r\n      fetchProfile(token)\r\n        .then((data) => {\r\n          setProfile(data);\r\n          setForm({ bio: data.bio || \"\", avatar: null });\r\n        })\r\n        .catch(() => {\r\n          setProfile(null);\r\n          navigate(\"/login\");\r\n        });\r\n    } else {\r\n      navigate(\"/login\");\r\n    }\r\n  }, [navigate]);\r\n\r\n  const handleChange = (e) => {\r\n    if (e.target.name === \"avatar\") {\r\n      setForm({ ...form, avatar: e.target.files[0] });\r\n    } else {\r\n      setForm({ ...form, [e.target.name]: e.target.value });\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const token = localStorage.getItem(\"token\");\r\n    if (!token) {\r\n      navigate(\"/login\");\r\n      return;\r\n    }\r\n\r\n    const formData = new FormData();\r\n    formData.append(\"bio\", form.bio);\r\n    if (form.avatar) formData.append(\"avatar\", form.avatar);\r\n\r\n    try {\r\n      await updateProfile(token, formData);\r\n      window.location.reload();\r\n    } catch (err) {\r\n      alert(\"Update failed\");\r\n    }\r\n  };\r\n\r\n  if (!profile) return <p>Loading...</p>;\r\n\r\n  return (\r\n    <div>\r\n      <h2>Profile</h2>\r\n      <img\r\n        src={profile.avatar ? profile.avatar : \"https://via.placeholder.com/100\"}\r\n        alt=\"avatar\"\r\n        width=\"100\"\r\n      />\r\n      <p>Username: {profile.username}</p>\r\n      <p>Email: {profile.email}</p>\r\n      <p>Reputation: {profile.reputation}</p>\r\n\r\n      <form onSubmit={handleSubmit}>\r\n        <textarea\r\n          name=\"bio\"\r\n          value={form.bio}\r\n          onChange={handleChange}\r\n          placeholder=\"Bio\"\r\n        />\r\n        <input type=\"file\" name=\"avatar\" onChange={handleChange} />\r\n        <button className=\"btn\" type=\"submit\">Update Profile</button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Profile;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}